"use strict";(self.webpackChunkscalarhub_docs_api=self.webpackChunkscalarhub_docs_api||[]).push([[3949],{8304:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>d,toc:()=>c});var n=r(74848),t=r(28453);const a={sidebar_position:4,id:"Cached usage responses"},i="Cached Usage Responses",d={id:"Cached usage responses",title:"Cached Usage Responses",description:"ScalarTax provides API endpoints to query usage data for accounts, customers, and other entities. These endpoints are optimized for performance, allowing applications to efficiently retrieve usage data while supporting caching mechanisms for faster responses.",source:"@site/docs/Cached usage responses.md",sourceDirName:".",slug:"/Cached usage responses",permalink:"/reference/Cached usage responses",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,id:"Cached usage responses"},sidebar:"tutorialSidebar",previous:{title:"Pagination",permalink:"/reference/Pagination"},next:{title:"Dry Run Requests",permalink:"/reference/Dry run requests"}},o={},c=[{value:"Header Semantics",id:"header-semantics",level:2},{value:"Request Headers",id:"request-headers",level:3},{value:"Supported Cache-Control Directives",id:"supported-cache-control-directives",level:4},{value:"Example Request Header",id:"example-request-header",level:4},{value:"Optional Conditional Headers",id:"optional-conditional-headers",level:3},{value:"Example Request with Conditional Caching",id:"example-request-with-conditional-caching",level:4},{value:"Response Headers",id:"response-headers",level:3},{value:"Example Response Header",id:"example-response-header",level:4},{value:"Example Response for Conditional Request",id:"example-response-for-conditional-request",level:4},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"<strong>How Dry Run Works</strong>",id:"how-dry-run-works",level:3},{value:"<strong>Header Semantics</strong>",id:"header-semantics-1",level:3},{value:"Response Headers",id:"response-headers-1",level:3},{value:"<strong>Unsupported Endpoints</strong>",id:"unsupported-endpoints",level:3}];function l(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"cached-usage-responses",children:"Cached Usage Responses"})}),"\n",(0,n.jsx)(s.p,{children:"ScalarTax provides API endpoints to query usage data for accounts, customers, and other entities. These endpoints are optimized for performance, allowing applications to efficiently retrieve usage data while supporting caching mechanisms for faster responses."}),"\n",(0,n.jsx)(s.p,{children:"ScalarTax supports cached responses to improve latency, especially when the latest data is not critical for your use case. This feature helps display historical data or power dashboard visualizations. When fresh data is required, you can fetch it directly from the source."}),"\n",(0,n.jsx)(s.h2,{id:"header-semantics",children:"Header Semantics"}),"\n",(0,n.jsx)(s.p,{children:"ScalarHub API uses standard HTTP headers to specify caching behavior, ensuring that cached responses are aligned with client requirements."}),"\n",(0,n.jsx)(s.h3,{id:"request-headers",children:"Request Headers"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Header Key \xa0 \xa0 \xa0 \xa0"}),(0,n.jsx)(s.th,{children:"Description \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0"})]})}),(0,n.jsx)(s.tbody,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Cache-Control"})}),(0,n.jsx)(s.td,{children:"Defines caching rules, including directives for expiration and revalidation of cached responses."})]})})]}),"\n",(0,n.jsx)(s.h4,{id:"supported-cache-control-directives",children:"Supported Cache-Control Directives"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"max-age=0"}),": Ensures the cached response is immediately stale and must be revalidated with the server."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"private"}),": Restricts cached data to individual users, preventing shared caching."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"must-revalidate"}),": Requires stale cached responses to be revalidated before being served to the client."]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"example-request-header",children:"Example Request Header"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-http",children:"GET /customers/{customer_id}/usage HTTP/1.1\r\nCache-Control: max-age=0, private, must-revalidate\n"})}),"\n",(0,n.jsx)(s.h3,{id:"optional-conditional-headers",children:"Optional Conditional Headers"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Header Key \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0"}),(0,n.jsx)(s.th,{children:"Description \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"If-Modified-Since"})}),(0,n.jsx)(s.td,{children:"Requests data only if it has been modified since the specified date. \xa0 \xa0"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"ETag"})}),(0,n.jsx)(s.td,{children:"Validates the version of cached data with the server. \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0"})]})]})]}),"\n",(0,n.jsx)(s.h4,{id:"example-request-with-conditional-caching",children:"Example Request with Conditional Caching"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-http",children:"GET /subscriptions/{subscription_id}/usage HTTP/1.1\r\nCache-Control: max-age=0, private, must-revalidate\r\nIf-Modified-Since: Mon, 18 Nov 2024 10:00:00 GMT\n"})}),"\n",(0,n.jsx)(s.h3,{id:"response-headers",children:"Response Headers"}),"\n",(0,n.jsx)(s.p,{children:"ScalarHub API responses include caching-related headers to indicate the freshness and validity of the returned data."}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Header Key \xa0 \xa0 \xa0 \xa0"}),(0,n.jsx)(s.th,{children:"Description \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Cache-Control"})}),(0,n.jsx)(s.td,{children:"Echoes the request's caching directives or specifies server-side caching rules."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Cache-Updated-At"})}),(0,n.jsx)(s.td,{children:"Timestamp in ISO 8601 format indicating the last time the cached data was updated."})]})]})]}),"\n",(0,n.jsx)(s.h4,{id:"example-response-header",children:"Example Response Header"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-http",children:"HTTP/1.1 200 OK\r\nCache-Control: max-age=0, private, must-revalidate\r\nCache-Updated-At: 2024-11-18T16:30:00Z\r\nContent-Type: application/json\n"})}),"\n",(0,n.jsx)(s.h4,{id:"example-response-for-conditional-request",children:"Example Response for Conditional Request"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-http",children:"HTTP/1.1 304 Not Modified\r\nCache-Control: max-age=0, private, must-revalidate\n"})}),"\n",(0,n.jsx)(s.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Freshness Prioritization"})," By default, caching ensures that the data served is validated against the latest available records, maintaining accuracy for billing and reporting."]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Reduced Latency"})," Conditional requests reduce unnecessary data transfers while maintaining data freshness."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.h1,{id:"dry-run-requests",children:"Dry Run Requests"}),"\n",(0,n.jsxs)(s.p,{children:["The ScalarTax API provides a ",(0,n.jsx)(s.strong,{children:"dry run"})," feature that allows you to test API requests without making any changes to the system. This feature is handy for validating the structure and correctness of a request before executing it in a production environment. It simulates the processing of a request and returns the expected response while ensuring no modifications are made to the system's data."]}),"\n",(0,n.jsx)(s.p,{children:"By performing a dry run, the API will simulate the processing of the request and return an expected result. However, no actual operations will be performed, such as data creation, updates, or deletions. This allows developers to confirm that their requests are structured correctly and will yield the expected responses before executing the actual actions."}),"\n",(0,n.jsx)(s.h3,{id:"how-dry-run-works",children:(0,n.jsx)(s.strong,{children:"How Dry Run Works"})}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Simulation"}),": A dry run processes the request as if it were real but does not persist any changes to the database or system state."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Validation"}),": It lets you preview the potential response, enabling you to identify errors or issues with your request before executing the real action."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"No Data Modification"}),": No updates, creations, or deletions will occur during a dry run request."]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"For example, if you create a new transaction or calculate taxes, the response will indicate the results as if the transaction were completed. However, the underlying data will remain unchanged, providing a safe way to test API behavior without impacting the system."}),"\n",(0,n.jsx)(s.h3,{id:"header-semantics-1",children:(0,n.jsx)(s.strong,{children:"Header Semantics"})}),"\n",(0,n.jsx)(s.p,{children:"To perform a dry run request, include the following header in your API request:"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Header \xa0 \xa0 \xa0"}),(0,n.jsx)(s.th,{children:"Value \xa0"})]})}),(0,n.jsx)(s.tbody,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"Dry-Run"})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.code,{children:"True"})})]})})]}),"\n",(0,n.jsx)(s.p,{children:"This header indicates to the ScalarTax API that the request should be simulated and that no changes will be made to the system."}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Example Request"}),": Creating a Transaction with Dry Run"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:'curl --request POST \'https://api.scalartax.ai/v1/transactions\' \\\r\n--header \'Dry-Run: True\' \\\r\n--header \'Accept: application/json\' \\\r\n--header \'Authorization: Bearer <your_token>\' \\\r\n--header \'Content-Type: application/json\' \\\r\n--data-raw \'{\r\n "transaction_id": "txn_12345",\r\n "amount": 1500.00,\r\n "currency": "USD",\r\n "tax_code": "TX001",\r\n "customer_id": "cust_7890"\r\n}\'\n'})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Response (Dry Run)"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-json",children:'{\r\n\xa0 "transaction_id": "txn_12345",\r\n\xa0 "amount": 1500.00,\r\n\xa0 "currency": "USD",\r\n\xa0 "tax_code": "TX001",\r\n\xa0 "customer_id": "cust_7890",\r\n\xa0 "status": "simulated",\r\n\xa0 "tax_amount": 120.00,\r\n\xa0 "total_amount": 1620.00\r\n}\n'})}),"\n",(0,n.jsxs)(s.p,{children:["This response confirms that the transaction was processed as a dry run. The status is marked as ",(0,n.jsx)(s.code,{children:"simulated"}),", and no changes persisted in the system."]}),"\n",(0,n.jsx)(s.h3,{id:"response-headers-1",children:"Response Headers"}),"\n",(0,n.jsxs)(s.p,{children:["When a request is sent with the ",(0,n.jsx)(s.code,{children:"Dry-Run"})," header, and the request is successfully processed as a dry run, the response will include the following header and value:"]}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Key \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0"}),(0,n.jsx)(s.th,{children:"Value \xa0"})]})}),(0,n.jsx)(s.tbody,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"Scalar-Dry-Run \xa0 \xa0"}),(0,n.jsx)(s.td,{children:"true \xa0 \xa0"})]})})]}),"\n",(0,n.jsx)(s.p,{children:"This response header confirms that the request was a dry run and that no changes were made to the data."}),"\n",(0,n.jsxs)(s.p,{children:["However, if the ",(0,n.jsx)(s.code,{children:"Dry-Run"})," header is included in the request but, for any reason, the request was not processed as a dry run (for instance, if the request is sent to an unsupported endpoint), the ",(0,n.jsx)(s.code,{children:"Scalar-Dry-Run"})," header will not be present in the response. This absence indicates that the request was executed typically rather than as a dry run."]}),"\n",(0,n.jsx)(s.h3,{id:"unsupported-endpoints",children:(0,n.jsx)(s.strong,{children:"Unsupported Endpoints"})}),"\n",(0,n.jsxs)(s.p,{children:["Not all endpoints support the dry run feature. When a request is sent to an unsupported endpoint with the ",(0,n.jsx)(s.code,{children:"Dry-Run"})," header, the API typically ignores the header and processes the request as usual. In such cases, the request will be executed like a standard operation, resulting in actual changes to the data."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Example of Unsupported Dry Run Request"})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"curl --request PUT 'https://api.scalartax.ai/v1/unsupported-endpoint' \\\r\n--header 'Dry-Run: True' \\\r\n--header 'Authorization: Bearer <your_token>' \\\r\n--data-raw '{\"data\": \"test\"}'\n"})}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Response"}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-json",children:'{\r\n\xa0 "error": "Endpoint not supported for dry run requests"\r\n}\n'})})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}}}]);